nohup: ignoring input
/home/sibivarshan_m7/MOFDiff/MOFDiff/mofdiff/common/eval_utils.py:57: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  with initialize_config_dir(str(model_path)):
/home/sibivarshan_m7/miniforge3/envs/mofdiff-gpu/lib/python3.10/site-packages/hydra/experimental/compose.py:25: UserWarning: hydra.experimental.compose() is no longer experimental. Use hydra.compose()
  deprecation_warning(message=message)

0it [00:00, ?it/s]/home/sibivarshan_m7/MOFDiff/MOFDiff/mofdiff/common/data_utils.py:331: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  unit_cell = torch.tensor(SUPERCELLS, device=device).float()

2it [00:00, 17.56it/s]
5it [00:00, 21.46it/s]
8it [00:00, 22.82it/s]
11it [00:00, 23.44it/s]
14it [00:00, 23.73it/s]
17it [00:00, 23.97it/s]
20it [00:00, 24.06it/s]
23it [00:00, 23.61it/s]
26it [00:01, 22.97it/s]
29it [00:01, 23.32it/s]
32it [00:01, 23.59it/s]
35it [00:01, 23.80it/s]
38it [00:01, 23.87it/s]
41it [00:01, 24.01it/s]
44it [00:01, 24.06it/s]
47it [00:01, 23.94it/s]
50it [00:02, 23.93it/s]
53it [00:02, 23.99it/s]
56it [00:02, 24.05it/s]
59it [00:02, 24.06it/s]
62it [00:02, 24.09it/s]
65it [00:02, 24.10it/s]
68it [00:02, 24.09it/s]
71it [00:02, 24.15it/s]
74it [00:03, 23.40it/s]
77it [00:03, 22.60it/s]
80it [00:03, 23.15it/s]
83it [00:03, 23.56it/s]
86it [00:03, 23.78it/s]
89it [00:03, 23.97it/s]
92it [00:03, 24.08it/s]
95it [00:04, 23.76it/s]
98it [00:04, 23.34it/s]
101it [00:04, 23.32it/s]
104it [00:04, 23.59it/s]
107it [00:04, 23.25it/s]
110it [00:04, 23.03it/s]
113it [00:04, 23.38it/s]
116it [00:04, 23.63it/s]
119it [00:05, 23.46it/s]
122it [00:05, 23.19it/s]
125it [00:05, 23.09it/s]
128it [00:05, 23.39it/s]
131it [00:05, 23.61it/s]
134it [00:05, 23.75it/s]
137it [00:05, 23.79it/s]
140it [00:05, 23.94it/s]
143it [00:06, 24.03it/s]
146it [00:06, 23.98it/s]
149it [00:06, 23.65it/s]
152it [00:06, 23.83it/s]
155it [00:06, 23.96it/s]
158it [00:06, 24.06it/s]
161it [00:06, 24.13it/s]
164it [00:06, 24.17it/s]
167it [00:07, 24.18it/s]
170it [00:07, 24.22it/s]
173it [00:07, 24.22it/s]
176it [00:07, 24.28it/s]
179it [00:07, 24.07it/s]
182it [00:07, 24.13it/s]
185it [00:07, 24.12it/s]
188it [00:07, 24.12it/s]
191it [00:08, 23.74it/s]
194it [00:08, 23.34it/s]
197it [00:08, 23.08it/s]
200it [00:08, 23.42it/s]
203it [00:08, 23.67it/s]
206it [00:08, 23.85it/s]
209it [00:08, 23.94it/s]
212it [00:08, 23.94it/s]
215it [00:09, 22.70it/s]
218it [00:09, 22.34it/s]
221it [00:09, 22.84it/s]
224it [00:09, 22.98it/s]
227it [00:09, 23.32it/s]
230it [00:09, 23.47it/s]
233it [00:09, 23.52it/s]
236it [00:09, 23.69it/s]
239it [00:10, 23.82it/s]
242it [00:10, 23.07it/s]
245it [00:10, 23.42it/s]
248it [00:10, 23.66it/s]
251it [00:10, 23.82it/s]
254it [00:10, 23.94it/s]
257it [00:10, 23.96it/s]
260it [00:10, 24.00it/s]
263it [00:11, 24.05it/s]
266it [00:11, 24.11it/s]
269it [00:11, 24.15it/s]
272it [00:11, 24.16it/s]
275it [00:11, 24.16it/s]
278it [00:11, 24.18it/s]
281it [00:11, 24.15it/s]
284it [00:11, 24.16it/s]
287it [00:12, 23.45it/s]
290it [00:12, 23.71it/s]
293it [00:12, 23.96it/s]
296it [00:12, 24.10it/s]
299it [00:12, 24.20it/s]
302it [00:12, 24.23it/s]
305it [00:12, 24.24it/s]
308it [00:12, 24.30it/s]
311it [00:13, 23.64it/s]
314it [00:13, 23.76it/s]
317it [00:13, 23.90it/s]
320it [00:13, 23.98it/s]
323it [00:13, 23.65it/s]
326it [00:13, 23.88it/s]
329it [00:13, 24.09it/s]
332it [00:13, 24.24it/s]
335it [00:14, 23.89it/s]
338it [00:14, 23.91it/s]
341it [00:14, 24.10it/s]
344it [00:14, 24.22it/s]
347it [00:14, 24.29it/s]
350it [00:14, 24.34it/s]
353it [00:14, 24.42it/s]
356it [00:14, 24.50it/s]
359it [00:15, 24.46it/s]
362it [00:15, 24.26it/s]
365it [00:15, 24.26it/s]
368it [00:15, 24.25it/s]
371it [00:15, 24.23it/s]
374it [00:15, 24.19it/s]
377it [00:15, 24.15it/s]
380it [00:15, 23.94it/s]
383it [00:16, 23.34it/s]
386it [00:16, 23.65it/s]
389it [00:16, 23.86it/s]
392it [00:16, 24.06it/s]
395it [00:16, 24.19it/s]
398it [00:16, 24.25it/s]
401it [00:16, 24.29it/s]
404it [00:16, 24.24it/s]
407it [00:17, 22.87it/s]
410it [00:17, 22.69it/s]
413it [00:17, 23.20it/s]
416it [00:17, 23.57it/s]
419it [00:17, 23.84it/s]
422it [00:17, 23.94it/s]
425it [00:17, 24.08it/s]
428it [00:17, 24.16it/s]
431it [00:18, 24.19it/s]
434it [00:18, 24.21it/s]
437it [00:18, 24.23it/s]
440it [00:18, 24.27it/s]
443it [00:18, 24.29it/s]
446it [00:18, 24.25it/s]
449it [00:18, 24.24it/s]
452it [00:18, 24.20it/s]
455it [00:19, 23.86it/s]
458it [00:19, 23.40it/s]
461it [00:19, 23.58it/s]
464it [00:19, 23.72it/s]
467it [00:19, 23.81it/s]
470it [00:19, 23.92it/s]
473it [00:19, 23.99it/s]
476it [00:19, 24.03it/s]
479it [00:20, 24.08it/s]
482it [00:20, 24.14it/s]
485it [00:20, 24.21it/s]
488it [00:20, 24.25it/s]
491it [00:20, 23.27it/s]
494it [00:20, 23.34it/s]
497it [00:20, 23.60it/s]
500it [00:21, 23.81it/s]
503it [00:21, 23.91it/s]
506it [00:21, 23.95it/s]
509it [00:21, 24.04it/s]
512it [00:21, 24.09it/s]
515it [00:21, 24.11it/s]
518it [00:21, 24.15it/s]
521it [00:21, 24.18it/s]
524it [00:21, 24.21it/s]
527it [00:22, 23.57it/s]
530it [00:22, 23.75it/s]
533it [00:22, 23.92it/s]
536it [00:22, 23.99it/s]
539it [00:22, 24.01it/s]
542it [00:22, 23.98it/s]
545it [00:22, 23.96it/s]
548it [00:23, 24.01it/s]
551it [00:23, 24.03it/s]
554it [00:23, 24.03it/s]
557it [00:23, 24.08it/s]
560it [00:23, 24.13it/s]
563it [00:23, 24.15it/s]
566it [00:23, 24.21it/s]
569it [00:23, 24.25it/s]
572it [00:23, 24.28it/s]
575it [00:24, 22.95it/s]
578it [00:24, 22.91it/s]
581it [00:24, 23.32it/s]
584it [00:24, 23.61it/s]
587it [00:24, 23.77it/s]
590it [00:24, 23.89it/s]
593it [00:24, 22.96it/s]
596it [00:25, 22.68it/s]
599it [00:25, 22.73it/s]
602it [00:25, 22.57it/s]
605it [00:25, 23.06it/s]
608it [00:25, 23.40it/s]
611it [00:25, 23.62it/s]
614it [00:25, 23.79it/s]
617it [00:25, 23.97it/s]
620it [00:26, 24.11it/s]
623it [00:26, 24.12it/s]
626it [00:26, 24.16it/s]
629it [00:26, 24.18it/s]
632it [00:26, 24.18it/s]
635it [00:26, 24.20it/s]
638it [00:26, 24.25it/s]
641it [00:26, 23.64it/s]
644it [00:27, 23.01it/s]
647it [00:27, 23.34it/s]
650it [00:27, 23.61it/s]
653it [00:27, 23.80it/s]
656it [00:27, 23.98it/s]
659it [00:27, 24.10it/s]
662it [00:27, 24.14it/s]
665it [00:27, 24.18it/s]
668it [00:28, 23.19it/s]
671it [00:28, 23.16it/s]
674it [00:28, 23.50it/s]
677it [00:28, 23.79it/s]
680it [00:28, 24.07it/s]
683it [00:28, 24.22it/s]
686it [00:28, 24.28it/s]
689it [00:28, 24.39it/s]
692it [00:29, 24.45it/s]
695it [00:29, 24.42it/s]
698it [00:29, 24.43it/s]
701it [00:29, 24.47it/s]
704it [00:29, 24.58it/s]
707it [00:29, 24.60it/s]
710it [00:29, 24.62it/s]
713it [00:29, 24.51it/s]
716it [00:30, 24.28it/s]
719it [00:30, 23.62it/s]
722it [00:30, 23.65it/s]
725it [00:30, 23.83it/s]
728it [00:30, 23.96it/s]
731it [00:30, 24.08it/s]
734it [00:30, 24.19it/s]
737it [00:30, 24.23it/s]
740it [00:31, 24.13it/s]
743it [00:31, 22.52it/s]
746it [00:31, 22.81it/s]
749it [00:31, 23.26it/s]
752it [00:31, 23.59it/s]
755it [00:31, 23.81it/s]
758it [00:31, 23.96it/s]
761it [00:31, 24.03it/s]
764it [00:32, 24.02it/s]
767it [00:32, 23.09it/s]
770it [00:32, 23.42it/s]
773it [00:32, 23.65it/s]
776it [00:32, 23.79it/s]
779it [00:32, 23.89it/s]
782it [00:32, 23.91it/s]
785it [00:32, 23.98it/s]
788it [00:33, 24.03it/s]
791it [00:33, 22.98it/s]
794it [00:33, 23.32it/s]
797it [00:33, 23.63it/s]
800it [00:33, 23.78it/s]
803it [00:33, 23.97it/s]
806it [00:33, 24.04it/s]
809it [00:33, 24.12it/s]
812it [00:34, 23.43it/s]
815it [00:34, 23.27it/s]
818it [00:34, 23.46it/s]
821it [00:34, 23.42it/s]
824it [00:34, 23.62it/s]
827it [00:34, 23.74it/s]
830it [00:34, 23.87it/s]
833it [00:34, 23.99it/s]
836it [00:35, 24.07it/s]
839it [00:35, 24.11it/s]
842it [00:35, 24.21it/s]
845it [00:35, 24.21it/s]
848it [00:35, 24.25it/s]
851it [00:35, 24.20it/s]
854it [00:35, 24.18it/s]
857it [00:35, 24.20it/s]
860it [00:36, 24.12it/s]
863it [00:36, 24.16it/s]
866it [00:36, 24.22it/s]
869it [00:36, 24.28it/s]
872it [00:36, 24.38it/s]
875it [00:36, 24.41it/s]
878it [00:36, 24.39it/s]
881it [00:36, 24.07it/s]
884it [00:37, 23.14it/s]
887it [00:37, 23.49it/s]
890it [00:37, 23.72it/s]
893it [00:37, 23.84it/s]
896it [00:37, 23.98it/s]
899it [00:37, 24.02it/s]
902it [00:37, 24.02it/s]
905it [00:37, 24.05it/s]
908it [00:38, 24.11it/s]
911it [00:38, 24.14it/s]
914it [00:38, 24.14it/s]
917it [00:38, 24.22it/s]
920it [00:38, 24.28it/s]
923it [00:38, 24.27it/s]
926it [00:38, 24.23it/s]
929it [00:38, 24.06it/s]
932it [00:39, 24.08it/s]
935it [00:39, 22.05it/s]
938it [00:39, 22.62it/s]
941it [00:39, 23.10it/s]
944it [00:39, 23.44it/s]
947it [00:39, 23.15it/s]
950it [00:39, 21.88it/s]
953it [00:40, 21.76it/s]
956it [00:40, 21.88it/s]
959it [00:40, 22.16it/s]
962it [00:40, 22.82it/s]
965it [00:40, 23.26it/s]
968it [00:40, 23.68it/s]
971it [00:40, 23.94it/s]
974it [00:40, 24.03it/s]
977it [00:41, 24.13it/s]
980it [00:41, 24.19it/s]
983it [00:41, 24.19it/s]
986it [00:41, 24.27it/s]
989it [00:41, 24.29it/s]
992it [00:41, 24.34it/s]
995it [00:41, 24.33it/s]
998it [00:41, 24.35it/s]
1001it [00:42, 24.38it/s]
1004it [00:42, 24.22it/s]
1007it [00:42, 24.18it/s]
1010it [00:42, 24.17it/s]
1013it [00:42, 24.27it/s]
1016it [00:42, 24.35it/s]
1019it [00:42, 24.30it/s]
1022it [00:42, 24.34it/s]
1025it [00:43, 24.41it/s]
1028it [00:43, 23.42it/s]
1031it [00:43, 23.57it/s]
1034it [00:43, 23.86it/s]
1037it [00:43, 24.08it/s]
1040it [00:43, 24.20it/s]
1043it [00:43, 24.27it/s]
1046it [00:43, 24.29it/s]
1049it [00:44, 24.36it/s]
1052it [00:44, 24.35it/s]
1055it [00:44, 24.34it/s]
1058it [00:44, 24.37it/s]
1061it [00:44, 23.81it/s]
1064it [00:44, 23.98it/s]
1067it [00:44, 24.14it/s]
1070it [00:44, 24.21it/s]
1073it [00:45, 24.25it/s]
1076it [00:45, 24.22it/s]
1079it [00:45, 24.28it/s]
1082it [00:45, 24.36it/s]
1085it [00:45, 24.38it/s]
1088it [00:45, 24.35it/s]
1091it [00:45, 24.32it/s]
1094it [00:45, 24.30it/s]
1097it [00:46, 24.35it/s]
1100it [00:46, 23.73it/s]
1103it [00:46, 23.16it/s]
1106it [00:46, 23.54it/s]
1109it [00:46, 23.76it/s]
1112it [00:46, 23.95it/s]
1115it [00:46, 24.05it/s]
1118it [00:46, 24.14it/s]
1121it [00:47, 24.18it/s]
1124it [00:47, 24.21it/s]
1127it [00:47, 23.28it/s]
1130it [00:47, 23.63it/s]
1133it [00:47, 23.87it/s]
1136it [00:47, 23.99it/s]
1139it [00:47, 24.08it/s]
1142it [00:47, 24.15it/s]
1145it [00:48, 24.23it/s]
1148it [00:48, 24.27it/s]
1151it [00:48, 23.82it/s]
1154it [00:48, 23.97it/s]
1157it [00:48, 24.10it/s]
1160it [00:48, 24.22it/s]
1163it [00:48, 24.24it/s]
1166it [00:48, 24.26it/s]
1169it [00:49, 24.27it/s]
1172it [00:49, 24.23it/s]
1175it [00:49, 24.21it/s]
1178it [00:49, 24.23it/s]
1181it [00:49, 24.24it/s]
1184it [00:49, 24.30it/s]
1187it [00:49, 24.33it/s]
1190it [00:49, 24.33it/s]
1193it [00:50, 24.27it/s]
1196it [00:50, 24.27it/s]
1199it [00:50, 23.49it/s]
1202it [00:50, 23.75it/s]
1205it [00:50, 23.99it/s]
1208it [00:50, 24.15it/s]
1211it [00:50, 24.27it/s]
1214it [00:50, 24.26it/s]
1217it [00:51, 24.21it/s]
1220it [00:51, 24.20it/s]
1223it [00:51, 24.27it/s]
1226it [00:51, 24.30it/s]
1229it [00:51, 24.34it/s]
1232it [00:51, 24.38it/s]
1235it [00:51, 24.39it/s]
1238it [00:51, 24.34it/s]
1241it [00:51, 24.33it/s]
1244it [00:52, 24.28it/s]
1247it [00:52, 24.22it/s]
1250it [00:52, 24.28it/s]
1253it [00:52, 24.29it/s]
1256it [00:52, 24.26it/s]
1259it [00:52, 24.18it/s]
1262it [00:52, 24.18it/s]
1265it [00:52, 23.98it/s]
1268it [00:53, 24.04it/s]
1271it [00:53, 24.04it/s]
1274it [00:53, 24.12it/s]
1277it [00:53, 24.20it/s]
1280it [00:53, 24.25it/s]
1283it [00:53, 24.32it/s]
1286it [00:53, 23.93it/s]
1289it [00:53, 23.54it/s]
1292it [00:54, 23.78it/s]
1295it [00:54, 23.96it/s]
1298it [00:54, 24.15it/s]
1301it [00:54, 24.27it/s]
1304it [00:54, 23.44it/s]
1307it [00:54, 23.52it/s]
1310it [00:54, 23.72it/s]
1313it [00:54, 23.90it/s]
1316it [00:55, 23.95it/s]
1319it [00:55, 23.78it/s]
1322it [00:55, 24.02it/s]
1325it [00:55, 24.17it/s]
1328it [00:55, 23.98it/s]
1331it [00:55, 24.06it/s]
1334it [00:55, 24.21it/s]
1337it [00:55, 24.35it/s]
1340it [00:56, 24.39it/s]
1343it [00:56, 23.84it/s]
1346it [00:56, 24.07it/s]
1349it [00:56, 24.21it/s]
1352it [00:56, 24.28it/s]
1355it [00:56, 24.36it/s]
1358it [00:56, 24.34it/s]
1361it [00:56, 24.33it/s]
1364it [00:57, 24.34it/s]
1367it [00:57, 24.35it/s]
1370it [00:57, 24.38it/s]
1373it [00:57, 24.34it/s]
1376it [00:57, 24.36it/s]
1379it [00:57, 24.34it/s]
1382it [00:57, 24.29it/s]
1385it [00:57, 24.28it/s]
1388it [00:58, 24.29it/s]
1391it [00:58, 23.82it/s]
1394it [00:58, 23.95it/s]
1397it [00:58, 24.11it/s]
1400it [00:58, 24.22it/s]
1403it [00:58, 24.25it/s]
1406it [00:58, 24.23it/s]
1409it [00:58, 24.29it/s]
1412it [00:59, 24.26it/s]
1415it [00:59, 24.21it/s]
1418it [00:59, 24.23it/s]
1421it [00:59, 24.26it/s]
1424it [00:59, 24.28it/s]
1427it [00:59, 24.32it/s]
1430it [00:59, 24.33it/s]
1433it [00:59, 24.28it/s]
1436it [01:00, 24.28it/s]
1439it [01:00, 24.27it/s]
1442it [01:00, 24.28it/s]
1445it [01:00, 24.28it/s]
1448it [01:00, 24.31it/s]
1451it [01:00, 24.31it/s]
1454it [01:00, 24.31it/s]
1457it [01:00, 23.88it/s]
1460it [01:01, 23.99it/s]
1463it [01:01, 24.08it/s]
1466it [01:01, 24.15it/s]
1469it [01:01, 24.23it/s]
1472it [01:01, 24.26it/s]
1475it [01:01, 24.33it/s]
1478it [01:01, 24.31it/s]
1481it [01:01, 24.34it/s]
1484it [01:02, 24.33it/s]
1487it [01:02, 24.36it/s]
1490it [01:02, 24.49it/s]
1493it [01:02, 24.59it/s]
1496it [01:02, 24.63it/s]
1499it [01:02, 24.66it/s]
1502it [01:02, 24.60it/s]
1505it [01:02, 24.60it/s]
1508it [01:03, 24.53it/s]
1511it [01:03, 24.44it/s]
1514it [01:03, 24.46it/s]
1517it [01:03, 24.55it/s]
1520it [01:03, 24.62it/s]
1523it [01:03, 24.66it/s]
1526it [01:03, 24.67it/s]
1529it [01:03, 24.60it/s]
1532it [01:03, 24.63it/s]
1535it [01:04, 24.48it/s]
1538it [01:04, 24.44it/s]
1541it [01:04, 24.49it/s]
1544it [01:04, 24.52it/s]
1547it [01:04, 24.55it/s]
1550it [01:04, 24.58it/s]
1553it [01:04, 24.56it/s]
1556it [01:04, 24.47it/s]
1559it [01:05, 24.42it/s]
1562it [01:05, 24.36it/s]
1565it [01:05, 24.38it/s]
1568it [01:05, 24.35it/s]
1571it [01:05, 24.33it/s]
1574it [01:05, 24.31it/s]
1577it [01:05, 24.29it/s]
1580it [01:05, 24.31it/s]
1583it [01:06, 23.02it/s]
1586it [01:06, 22.90it/s]
1589it [01:06, 23.34it/s]
1592it [01:06, 23.68it/s]
1595it [01:06, 23.89it/s]
1598it [01:06, 24.03it/s]
1601it [01:06, 24.13it/s]
1604it [01:06, 24.18it/s]
1607it [01:07, 24.21it/s]
1610it [01:07, 24.22it/s]
1613it [01:07, 24.29it/s]
1616it [01:07, 24.31it/s]
1619it [01:07, 24.36it/s]
1622it [01:07, 24.31it/s]
1625it [01:07, 24.29it/s]
1628it [01:07, 24.30it/s]
1631it [01:08, 24.32it/s]
1634it [01:08, 24.24it/s]
1637it [01:08, 24.06it/s]
1640it [01:08, 24.15it/s]
1643it [01:08, 24.18it/s]
1646it [01:08, 24.20it/s]
1649it [01:08, 24.14it/s]
1652it [01:08, 24.17it/s]
1655it [01:09, 24.14it/s]
1658it [01:09, 24.09it/s]
1661it [01:09, 24.13it/s]
1664it [01:09, 24.17it/s]
1667it [01:09, 24.20it/s]
1670it [01:09, 24.21it/s]
1673it [01:09, 24.24it/s]
1676it [01:09, 24.24it/s]
1679it [01:10, 24.27it/s]
1682it [01:10, 23.98it/s]
1685it [01:10, 24.09it/s]
1688it [01:10, 24.17it/s]
1691it [01:10, 24.23it/s]
1694it [01:10, 24.25it/s]
1697it [01:10, 24.28it/s]
1700it [01:10, 24.30it/s]
1703it [01:11, 24.29it/s]
1706it [01:11, 24.25it/s]
1709it [01:11, 24.28it/s]
1712it [01:11, 24.34it/s]
1715it [01:11, 24.33it/s]
1718it [01:11, 24.34it/s]
1721it [01:11, 24.33it/s]
1724it [01:11, 24.33it/s]
1727it [01:12, 23.99it/s]
1730it [01:12, 23.51it/s]
1733it [01:12, 23.73it/s]
1736it [01:12, 23.94it/s]
1739it [01:12, 24.08it/s]
1742it [01:12, 24.15it/s]
1745it [01:12, 24.14it/s]
1748it [01:12, 23.36it/s]
1751it [01:13, 22.63it/s]
1754it [01:13, 22.63it/s]
1757it [01:13, 22.79it/s]
1760it [01:13, 22.15it/s]
1763it [01:13, 22.68it/s]
1766it [01:13, 23.11it/s]
1769it [01:13, 22.61it/s]
1772it [01:14, 22.90it/s]
1775it [01:14, 23.18it/s]
1778it [01:14, 22.43it/s]
1781it [01:14, 23.01it/s]
1784it [01:14, 23.40it/s]
1787it [01:14, 23.70it/s]
1790it [01:14, 23.88it/s]
1793it [01:14, 23.62it/s]
1796it [01:15, 22.76it/s]
1799it [01:15, 22.82it/s]
1802it [01:15, 23.37it/s]
1805it [01:15, 23.80it/s]
1808it [01:15, 24.07it/s]
1811it [01:15, 24.26it/s]
1814it [01:15, 24.36it/s]
1817it [01:15, 24.43it/s]
1820it [01:16, 23.38it/s]
1823it [01:16, 22.89it/s]
1826it [01:16, 23.32it/s]
1829it [01:16, 23.68it/s]
1832it [01:16, 23.88it/s]
1835it [01:16, 24.03it/s]
1838it [01:16, 24.18it/s]
1841it [01:16, 24.24it/s]
1844it [01:17, 24.27it/s]
1847it [01:17, 24.30it/s]
1850it [01:17, 24.35it/s]
1853it [01:17, 24.40it/s]
1856it [01:17, 24.40it/s]
1859it [01:17, 24.39it/s]
1862it [01:17, 24.32it/s]
1865it [01:17, 24.33it/s]
1868it [01:18, 24.29it/s]
1871it [01:18, 24.30it/s]
1874it [01:18, 24.31it/s]
1877it [01:18, 24.41it/s]
1880it [01:18, 24.53it/s]
1883it [01:18, 24.62it/s]
1886it [01:18, 24.60it/s]
1889it [01:18, 24.60it/s]
1892it [01:19, 24.62it/s]
1895it [01:19, 24.52it/s]
1898it [01:19, 23.81it/s]
1901it [01:19, 23.23it/s]
1904it [01:19, 23.54it/s]
1907it [01:19, 23.76it/s]
1910it [01:19, 23.91it/s]
1913it [01:19, 24.00it/s]
1916it [01:20, 24.01it/s]
1919it [01:20, 24.11it/s]
1922it [01:20, 23.42it/s]
1925it [01:20, 23.85it/s]
1928it [01:20, 24.16it/s]
1931it [01:20, 24.33it/s]
1934it [01:20, 24.46it/s]
1937it [01:20, 24.50it/s]
1940it [01:21, 24.52it/s]
1943it [01:21, 24.08it/s]
1946it [01:21, 23.73it/s]
1949it [01:21, 23.94it/s]
1952it [01:21, 23.86it/s]
1955it [01:21, 23.96it/s]
1958it [01:21, 24.07it/s]
1961it [01:21, 24.17it/s]
1964it [01:22, 24.26it/s]
1967it [01:22, 24.24it/s]
1970it [01:22, 24.28it/s]
1973it [01:22, 24.28it/s]
1976it [01:22, 24.29it/s]
1979it [01:22, 24.33it/s]
1982it [01:22, 24.31it/s]
1985it [01:22, 24.28it/s]
1988it [01:23, 24.32it/s]
1991it [01:23, 24.30it/s]
1994it [01:23, 24.31it/s]
1997it [01:23, 24.28it/s]
1999it [01:23, 23.95it/s]
Traceback (most recent call last):
  File "/home/sibivarshan_m7/MOFDiff/MOFDiff/scripts/generate_nh3_optimized.py", line 488, in <module>
    main()
  File "/home/sibivarshan_m7/MOFDiff/MOFDiff/scripts/generate_nh3_optimized.py", line 476, in main
    run_gcmc(output_dir)
  File "/home/sibivarshan_m7/MOFDiff/MOFDiff/scripts/generate_nh3_optimized.py", line 278, in run_gcmc
    result = subprocess.run(
  File "/home/sibivarshan_m7/miniforge3/envs/mofdiff-gpu/lib/python3.10/subprocess.py", line 505, in run
    stdout, stderr = process.communicate(input, timeout=timeout)
  File "/home/sibivarshan_m7/miniforge3/envs/mofdiff-gpu/lib/python3.10/subprocess.py", line 1154, in communicate
    stdout, stderr = self._communicate(input, endtime, timeout)
  File "/home/sibivarshan_m7/miniforge3/envs/mofdiff-gpu/lib/python3.10/subprocess.py", line 2022, in _communicate
    self._check_timeout(endtime, orig_timeout, stdout, stderr)
  File "/home/sibivarshan_m7/miniforge3/envs/mofdiff-gpu/lib/python3.10/subprocess.py", line 1198, in _check_timeout
    raise TimeoutExpired(
subprocess.TimeoutExpired: Command 'conda run -n mofdiff-gpu python mofdiff/scripts/gcmc_nh3_screen.py --input /home/sibivarshan_m7/MOFDiff/MOFDiff/results/nh3_optimized_5.0/relaxed --ncpu 4 --simulation_type uptake --temperature 298 --pressure 101325' timed out after 7200 seconds

ERROR conda.cli.main_run:execute(127): `conda run python scripts/generate_nh3_optimized.py --target 5.0 --n_samples 10 --model_path pretrained/mofdiff_ckpt --bb_cache_path pretrained/bb_emb_space.pt --predictor_path pretrained/nh3_optimizer.pt --output_dir results/nh3_optimized_5.0 --opt_steps 300 --device cuda` failed. (See above for error)

======================================================================
STEP 1: Optimizing Latent Vectors for 5.0 mmol/g NH3
======================================================================

============================================================
NH3 Latent Optimizer
============================================================
Target: 5.00 mmol/g
Starts: 20, Steps: 300, LR: 0.05
KL weight: 0.005, Uncertainty weight: 0.1
============================================================

Step  50: target_loss=0.0020, pred=4.958±2.141, range=[4.88, 5.06], kl=0.914
Step 100: target_loss=0.0007, pred=4.965±1.936, range=[4.96, 4.98], kl=0.936
Step 150: target_loss=0.0002, pred=4.990±1.906, range=[4.96, 5.02], kl=0.922
Step 200: target_loss=0.0000, pred=4.998±1.903, range=[4.97, 5.01], kl=0.897
Step 250: target_loss=0.0000, pred=4.998±1.901, range=[4.97, 5.00], kl=0.885
Step 300: target_loss=0.0000, pred=4.998±1.901, range=[4.97, 5.00], kl=0.883

============================================================
Optimization Complete (best at step 288)
============================================================
Selected 10 optimized latent vectors:
  z[0]: predicted=5.000 ± 1.882 mmol/g (target=5.00)
  z[1]: predicted=5.000 ± 1.962 mmol/g (target=5.00)
  z[2]: predicted=5.000 ± 2.081 mmol/g (target=5.00)
  z[3]: predicted=5.000 ± 1.616 mmol/g (target=5.00)
  z[4]: predicted=5.000 ± 1.681 mmol/g (target=5.00)
  z[5]: predicted=5.000 ± 2.042 mmol/g (target=5.00)
  z[6]: predicted=5.000 ± 1.976 mmol/g (target=5.00)
  z[7]: predicted=4.999 ± 1.830 mmol/g (target=5.00)
  z[8]: predicted=4.999 ± 1.847 mmol/g (target=5.00)
  z[9]: predicted=4.999 ± 2.039 mmol/g (target=5.00)
/home/sibivarshan_m7/MOFDiff/MOFDiff/.env

======================================================================
STEP 2: Generating MOFs with Optimized Latent Vectors
======================================================================
Loading MOFDiff model from /home/sibivarshan_m7/MOFDiff/MOFDiff/pretrained/mofdiff_ckpt...
load model.
Loading building block cache from pretrained/bb_emb_space.pt...
Building KDTree...
Sampling 10 MOFs with optimized latent vectors...
  Batch 1/1 (10 samples)...
Saving samples to /home/sibivarshan_m7/MOFDiff/MOFDiff/results/nh3_optimized_5.0/samples.pt...

======================================================================
STEP 3: Assembling MOF Structures
======================================================================
Macthed connection criteria violated
Macthed connection criteria violated
Macthed connection criteria violated
Macthed connection criteria violated
Macthed connection criteria violated
Macthed connection criteria violated
/home/sibivarshan_m7/MOFDiff/MOFDiff/results/nh3_optimized_5.0/samples.pt -- done!


✓ Assembled 4 structures

======================================================================
STEP 4: LAMMPS UFF Relaxation
======================================================================
ail yes mix arithmetic
dielectric      1.0
box tilt        large
read_data       data.sample_3


units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 12.500
bond_style      harmonic
angle_style     hybrid cosine/periodic fourier
dihedral_style  harmonic
improper_style  fourier

pair_modify     tail yes mix arithmetic
dielectric      1.0
special_bonds   lj/coul 0.0 0.0 1.0
box tilt        large
read_data       data.sample_2


units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 12.500
bond_style      harmonic
angle_style     hybrid cosine/periodic fourier
dihedral_style  harmonic
improper_style  fourier

pair_modify     tail yes mix arithmetic
special_bonds   lj/coul 0.0 0.0 1.0
dielectric      1.0
box tilt        large
read_data       data.sample_6


expected str, bytes or os.PathLike object, not NoneType
expected str, bytes or os.PathLike object, not NoneType
expected str, bytes or os.PathLike object, not NoneType


✓ Relaxed 4 structures

======================================================================
STEP 5: GCMC NH3 Screening
======================================================================

